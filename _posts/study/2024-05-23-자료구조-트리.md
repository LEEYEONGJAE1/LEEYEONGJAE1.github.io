---
layout: post
title: 자료구조 - red-black tree
study: true
published: true
use_math: true
---

## red black tree

binary search tree의 단점(unbalanced)을 보완한 balanced(self-balancing) binary search tree이고, 다음 속성을 이용해 삽입, 검색, 제거를 모두 $log(n)$의 시간복잡도로 수행한다. 

- 노드 색상 : 각 노드는 빨간색 또는 검은색
- 루트 속성 : 루트는 항상 검은색
- Red 속성 : red 노드는 red 자식을 가질 수 없음(어떤 경로에서든 두 개의 연속된 red 노드는 불가)
- Black 속성 : 노드에서 그 하위 리프 노드까지의 모든 경로에는 동일한 수의 블랙 노드가 있습니다.
- 리프 속성 : 모든 리프 노드는 검은색

이러한 속성은 루트에서 리프까지의 가장 긴 경로가 최단 경로의 두 배를 넘지 않도록 하여 트리의 균형과 효율적인 성능을 유지

## 연산의 종류

### rotate

#### left rotate
<img src="\assets\images\study\red-black-tree\left-rotate.png" width="40%" height="40%" />


$x$ 노드에 left rotate:

1. $y$를 $x$의 오른쪽 자식으로 설정
2. $y$ 의 왼쪽 하위 트리를 $x$ 의 오른쪽 하위 트리 로 이동
3. $x$ 및 $y$ 의 부모를 업데이트
4. $x$ 대신 $y$를 가리키도록 $x$ 의 부모를 업데이트
5. $y$ 의 왼쪽 자식을 $x$ 로 설정
6. $x$ 의 부모를 $y$ 로 업데이트

#### right rotate
<img src="\assets\images\study\red-black-tree\right-rotate.png" width="40%" height="40%" />

$x$ 노드에 right rotate:

1. $y$를 $x$의 왼쪽 자식으로 설정
2. $y$의 오른쪽 하위 트리를 $x$의 왼쪽 하위 트리로 이동
3. $x$ 및 $y$의 부모를 업데이트
4. $x$ 대신 $y$를 가리키도록 $x$의 부모를 업데이트
5. $y$ 의 오른쪽 자식을 $x$로 설정
6. $x$ 의 부모를 $y$로 업데이트

### insert
새로 삽입한 노드를 $Z$라고 한다. 새로 삽입한 노드는 **빨간색**으로 칠한다. 

<img src="\assets\images\study\red-black-tree\insert-scenario.png" width="40%" height="40%" />

4가지 scenario가 있다. 

1. $Z$가 root

    검은색으로 recolor(red-black tree의 속성)

2. $Z$의 uncle(Z의 부모 노드의 형제 노드)이 빨간색 (uncle이 존재하지 않으면 black으로 침)

    <img src="\assets\images\study\red-black-tree\insert-uncle-red.png" 
width="30%" height="30%" />

    <img src="\assets\images\study\red-black-tree\insert-uncle-red-solution.png" 
width="30%" height="30%" />

3. $Z$의 uncle이 검은색, $Z$와 $Z$의 부모, $Z$의 부모의 부모가 triangle

    <img src="\assets\images\study\red-black-tree\insert-triangle.png" 
width="30%" height="30%" />

    <img src="\assets\images\study\red-black-tree\insert-triangle-solution-1.png" 
width="30%" height="30%" /> 
    <img src="\assets\images\study\red-black-tree\insert-triangle-solution-2.png" 
width="30%" height="30%" />

4. $Z$의 uncle이 검은색, $Z$와 $Z$의 부모, $Z$의 부모의 부모가 line

    <img src="\assets\images\study\red-black-tree\insert-line.png" 
width="30%" height="30%" />

    <img src="\assets\images\study\red-black-tree\insert-line-solution-1.png" 
width="30%" height="30%" />
    <img src="\assets\images\study\red-black-tree\insert-line-solution-2.png" 
width="30%" height="30%" />
    <img src="\assets\images\study\red-black-tree\insert-line-solution-3.png" 
width="30%" height="30%" />

### delete

### search
binary search tree와 동일

reference:
- [https://www.geeksforgeeks.org/introduction-to-red-black-tree/](https://www.geeksforgeeks.org/introduction-to-red-black-tree/)
- [Red-Black Trees - Michael Sambol](https://youtube.com/playlist?list=PL9xmBV_5YoZNqDI8qfOZgzbqahCUmUEin&si=o9tnDbmMBGicmvns)